function afficher_masquer_images_action(a){if(a=='show'){$('form q').show()}else if(a=='hide'){$('form q').hide()}}function format_liens(a){$(a).find("a.lien_ext").attr("target","_blank");$(a).find("a.lien_ext").css({"padding-right":"14px","background":"url(./_img/popup2.gif) no-repeat right"});$(a).find("a.pop_up").css({"padding-right":"18px","background":"url(./_img/popup1.gif) no-repeat right"});$(a).find("a.lien_mail").css({"padding-left":"15px","background":"url(./_img/mail.gif) no-repeat left"})}function infobulle(){$('img[title]').tooltip({showURL:false});$('th[title]').tooltip({showURL:false});$('td[title]').tooltip({showURL:false});$('a[title]').tooltip({showURL:false});$('q[title]').tooltip({showURL:false})}function preloadImages(a){var b='./_img/';for(var i=0;i<a.length;i++){$('<img/>').attr('src',b+a[i])}}function maj_clock(a){DUREE_RESTANTE=(a==-1)?DUREE_RESTANTE-1:DUREE_AUTORISEE;if(DUREE_RESTANTE>5){$("#clock").html('<img alt="" src="./_img/clock_fixe.png" /> '+DUREE_RESTANTE+' min');if((a==-1)&&(DUREE_RESTANTE%10==0)){conserver_session_active()}}else{setVolume(100);play("bip");$("#clock").html('<img alt="" src="./_img/clock_anim.gif" /> '+DUREE_RESTANTE+' min');if(DUREE_RESTANTE==0){$('q.deconnecter').click()}}}function conserver_session_active(){$.ajax({type:'GET',url:'ajax.php?dossier='+DOSSIER+'&fichier=conserver_session_active',data:'',dataType:"html",error:function(a,b){alert('Avertissement : échec lors de la connexion au serveur !\nLe travail en cours pourrait ne pas pouvoir être sauvegardé...')},success:function(a){if(a!='ok'){alert(a)}}})}var myListener=new Object();myListener.onInit=function(){this.position=0};myListener.onUpdate=function(){info_playing=this.isPlaying;info_url=this.url;info_volume=this.volume;info_position=this.position;info_duration=this.duration;info_bytes=this.bytesLoaded+"/"+this.bytesTotal+" ("+this.bytesPercent+"%)";var a=(this.isPlaying=="true")};function getFlashObject(){return document.getElementById("myFlash")}function play(a){if(myListener.position==0){getFlashObject().SetVariable("method:setUrl","./_mp3/"+a+".mp3")}getFlashObject().SetVariable("method:play","");getFlashObject().SetVariable("enabled","true")}function pause(){getFlashObject().SetVariable("method:pause","")}function stop(){getFlashObject().SetVariable("method:stop","")}function setPosition(a){getFlashObject().SetVariable("method:setPosition",a)}function setVolume(a){getFlashObject().SetVariable("method:setVolume",a)}$(document).ready(function(){format_liens('body');infobulle();var f=Array('ajax/ajax_alerte.png','ajax/ajax_erreur.png','ajax/ajax_loader.gif','ajax/ajax_valide.png','puce_danger.gif','folder/folder_m1.png','folder/folder_m2.png','folder/folder_n0.png','folder/folder_n1.png','folder/folder_n2.png','folder/folder_n3.png');preloadImages(f);$("#treeview li").each(function(){classe=$(this).attr("class");if(classe){$(this).css("background","url(./_img/menu/"+classe+".png) no-repeat top left")}});$("#appel_menu").hover(function(){$("#treeview").show()},function(){});$("#treeview").hover(function(){},function(){$("#treeview").hide()});$('#zone_compet li span').siblings('ul').hide('fast');$('#zone_compet li span').live('click',function(){$(this).siblings('ul').toggle()});$('#zone_paliers li span').siblings('ul').hide('fast');$('#zone_paliers li span').live('click',function(){$(this).siblings('ul').toggle()});$('#zone_socle li span').siblings('ul').hide('fast');$('#zone_socle li span').click(function(){$(this).siblings('ul').toggle()});$('#zone_eleve li span').siblings('ul').hide('fast');$('#zone_eleve li span').click(function(){$(this).siblings('ul').toggle()});$('q.deconnecter').click(function(){window.document.location.href='./index.php'});$('a.toggle').click(function(){$("div.toggle").toggle("slow");return false});$('img.toggle').live('click',function(){id=$(this).parent().attr('lang');$('#'+id).toggle('fast');src=$(this).attr('src');if(src.indexOf("plus")>0){$(this).attr('src',src.replace('plus','moins'))}else{$(this).attr('src',src.replace('moins','plus'))}return false});$('a.pop_up').live('click',function(){adresse=$(this).attr("href");if(window.name!='popup'){var a=Math.max(1000,screen.width-600);var b=screen.height*1;var c=0;var d=0;window.moveTo(c,d);window.resizeTo(a,b)}var a=(adresse.substring(19,25)!='intro-')?600:800;var b=screen.height*1;var c=screen.width-a;var d=0;w=window.open(adresse,'popup',"toolbar=no,location=no,menubar=no,directories=no,status=no,scrollbars=yes,resizable=yes,copyhistory=no,width="+a+",height="+b+",top="+d+",left="+c);w.focus();return false});if(DOSSIER!='public'){$("body").everyTime('60s',function(){maj_clock(-1)})}$('<div id="calque"></div>').appendTo(document.body).hide();var g=false;$('q.date_calendrier').live('click',function(e){champ=$(this).prev().attr("id");date_fr=$(this).prev().attr("value");tab_date=date_fr.split('/');if(tab_date.length==3){jour=tab_date[0];mois=tab_date[1];annee=tab_date[2];get_data='j='+jour+'&m='+mois+'&a='+annee}else{get_data=''}posX=e.pageX-5;posY=e.pageY-5;$("#calque").css('left',posX+'px');$("#calque").css('top',posY+'px');$("#calque").html('<label id="ajax_alerte_calque" for="nada" class="loader">Chargement en cours...</label>').show();$.ajax({type:'GET',url:'ajax.php?dossier=public&fichier=date_calendrier',data:get_data,dataType:"html",error:function(a,b){$('#ajax_alerte_calque').removeAttr("class").addClass("alerte").html("Echec de la connexion !");g=true},success:function(a){if(a.substring(0,4)=='<h5>'){$('#calque').html(a);g=false}else{$('#ajax_alerte_calque').removeAttr("class").addClass("alerte").html(a);g=true}}})});$('q.demander_add').live('click',function(e){infos=$(this).attr("lang");tab_infos=infos.split('_');if(tab_infos.length==5){eleve_id=tab_infos[1];matiere_id=tab_infos[2];item_id=tab_infos[3];score=(tab_infos[4]!='')?tab_infos[4]:-1;get_data='eleve_id='+eleve_id+'&matiere_id='+matiere_id+'&item_id='+item_id+'&score='+score}else{return false}posX=e.pageX-5;posY=e.pageY-5;$("#calque").css('left',posX+'px');$("#calque").css('top',posY+'px');$("#calque").html('<label id="ajax_alerte_calque" for="nada" class="loader">Chargement en cours...</label>').show();$.ajax({type:'GET',url:'ajax.php?dossier=public&fichier=demander_add',data:get_data,dataType:"html",error:function(a,b){$('#ajax_alerte_calque').removeAttr("class").addClass("alerte").html("Echec de la connexion !");g=true},success:function(a){if(a.substring(0,5)=='<form'){maj_clock(1);$('#calque').html(a);g=true}else{$('#ajax_alerte_calque').removeAttr("class").addClass("alerte").html(a);g=true}}})});$("#calque").mouseleave(function(){if(g){$("#calque").html('&nbsp;').hide()}});$("#form_calque input[name=fermer]").live('click',function(){$("#calque").html('&nbsp;').hide();return false});$("#form_calque a.actu").live('click',function(){retour=$(this).attr("href");retour=retour.replace(/\-/g,"/");$("#"+champ).val(retour).focus();$("#calque").html('&nbsp;').hide();return false});function reload_calendrier(b,c){$.ajax({type:'GET',url:'ajax.php?dossier=public&fichier=date_calendrier',data:'m='+b+'&a='+c,dataType:"html",success:function(a){if(a.substring(0,4)=='<h5>'){$('#calque').html(a)}}})}$("#form_calque select.actu").live('change',function(){m=$("#m option:selected").val();a=$("#a option:selected").val();reload_calendrier(m,a)});$("#form_calque input.actu").live('click',function(){tab=$(this).attr("lang").split('_');m=tab[0];a=tab[1];reload_calendrier(m,a);return false})});
